(function(){Thread=function(a){if(!window.URL||!window.URL.createObjectURL||!window.URL.revokeObjectURL||!window.Blob||!window.Worker)throw new ThreadError("could not create thread, not all necessary dependencies are defined");if("function"===typeof a||a instanceof HTMLScriptElement){a="function"===typeof a?a.toString().match(/^function\s*\([^\)]*\)\s*\{\s*((\S|\s)*\S)\s*\}$/)[1]:a.textContent.match(/^\s*(.+)\s*$/)[1];if(""===a)throw new ThreadError("could not create thread, script does not contain any commands");
var b=window.URL.createObjectURL(new Blob([a],{type:"application/javascript"}));delete a}else if("string"===typeof a){a=a.match(/\S+/);if(!a)throw new ThreadError("could not create thread, passed argument does not contain any file name");b=a[0]}else throw new ThreadError("could not create thread, passed argument is neither a function nor a script element nor a file");var c=!0,d=new Worker(b);d.addEventListener("error",function(){d.terminate();window.URL.revokeObjectURL(b);c=null},!1);this.getStatus=
function(){return c};this.kill=function(){return c?(d.terminate(),window.URL.revokeObjectURL(b),c=!1,!0):null};this.postMessage=function(a){c&&d.postMessage(a)};this.addEventListener=function(a,b,e){return c?d.addEventListener(a,b,e):null};this.removeEventListener=function(a,b,e){return c?d.removeEventListener(a,b,e):null};this.dispatchEvent=function(a){return c?d.dispatchEvent(a):null};Object.defineProperty(this,"status",{get:function(){return this.getStatus()}});Object.defineProperty(this,"running",
{get:function(){return!0===this.getStatus()}});Object.defineProperty(this,"terminated",{get:function(){return!0!==this.getStatus()}})};Thread.kill=function(a){return a instanceof Thread?a.kill():!1};ThreadError=function(a){a=a||"unknown error";this.toString=function(){return"ThreadError: "+a}}})();
